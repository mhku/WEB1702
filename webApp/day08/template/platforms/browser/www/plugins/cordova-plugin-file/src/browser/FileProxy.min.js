cordova.define("cordova-plugin-file.browserFileProxy",function(b,a,c){(function(){if(b("./isChrome")()){var g={applicationDirectory:location.origin+"/",dataDirectory:"filesystem:file:///persistent/",cacheDirectory:"filesystem:file:///temporary/"};a.requestAllPaths=function(k){k(g)};b("cordova/exec/proxy").add("File",c.exports);return}var e=b("./LocalFileSystem"),f=b("./FileSystem"),j=b("./FileEntry"),i=b("./FileError"),h=b("./DirectoryEntry"),d=b("./File");(function(r,n){var q=n.indexedDB||n.mozIndexedDB;if(!q){throw"Firefox OS File plugin: indexedDB not supported"}var l=null;var p={};p.db=null;var x="entries";var o="/";var k={applicationDirectory:location.origin+"/",dataDirectory:"file:///persistent/",cacheDirectory:"file:///temporary/"};var t=65535;r.requestFileSystem=function(y,A,C){var F=C[0];var E=C[1];if(F!==e.TEMPORARY&&F!==e.PERSISTENT){if(A){A(i.INVALID_MODIFICATION_ERR)}return}var B=F===e.TEMPORARY?"temporary":"persistent";var D=(location.protocol+location.host).replace(/:/g,"_");var z=new h("",o);l=new f(B,z);p.open(D,function(){y(l)},A)};b("./fileSystems").getFs=function(y,z){z(new f(y,l.root))};r.readEntries=function(y,z,B){var A=B[0];if(typeof y!=="function"){throw Error("Expected successCallback argument.")}var C=v(A);r.getDirectory(function(){p.getAllEntries(C.fullPath+o,C.storagePath,function(D){y(D)},z)},function(){if(z){z(i.NOT_FOUND_ERR)}},[C.storagePath,C.fullPath,{create:false}])};r.getFile=function(y,z,C){var B=C[0];var D=C[1];var A=C[2]||{};D=v(B,D);p.get(D.storagePath,function(F){if(A.create===true&&A.exclusive===true&&F){if(z){z(i.PATH_EXISTS_ERR)}}else{if(A.create===true&&!F){var E=new j(D.fileName,D.fullPath,new f(D.fsName,l.root));E.file_=new u({size:0,name:E.name,lastModifiedDate:new Date(),storagePath:D.storagePath});p.put(E,D.storagePath,y,z)}else{if(A.create===true&&F){if(F.isFile){p["delete"](D.storagePath,function(){var G=new j(D.fileName,D.fullPath,new f(D.fsName,l.root));G.file_=new u({size:0,name:G.name,lastModifiedDate:new Date(),storagePath:D.storagePath});p.put(G,D.storagePath,y,z)},z)}else{if(z){z(i.INVALID_MODIFICATION_ERR)}}}else{if((!A.create||A.create===false)&&!F){if(z){z(i.NOT_FOUND_ERR)}}else{if((!A.create||A.create===false)&&F&&F.isDirectory){if(z){z(i.TYPE_MISMATCH_ERR)}}else{y(m(F))}}}}}},z)};r.getFileMetadata=function(y,z,B){var A=B[0];r.getFile(function(C){y(new d(C.file_.name,C.fullPath,"",C.file_.lastModifiedDate,C.file_.size))},z,[A,null])};r.getMetadata=function(y,z,A){r.getFile(function(B){y({modificationTime:B.file_.lastModifiedDate,size:B.file_.lastModifiedDate})},z,A)};r.setMetadata=function(y,z,C){var B=C[0];var A=C[1];r.getFile(function(D){D.file_.lastModifiedDate=A.modificationTime;p.put(D,D.file_.storagePath,y,z)},z,[B,null])};r.write=function(z,A,B){var E=B[0],D=B[1],y=B[2],C=B[3];if(!D){if(A){A(i.INVALID_MODIFICATION_ERR)}return}if(typeof D==="string"||D instanceof String){D=new Blob([D])}r.getFile(function(J){var I=J.file_.blob_;if(!I){I=new Blob([D],{type:D.type})}else{var G=I.slice(0,y);var F=I.slice(y+(D.size||D.byteLength));var H=y-G.size;if(H<0){H=0}I=new Blob([G,new Uint8Array(H),D,F],{type:D.type})}J.file_.blob_=I;J.file_.lastModifiedDate=new Date()||null;J.file_.size=I.size;J.file_.name=I.name;J.file_.type=I.type;p.put(J,J.file_.storagePath,function(){z(D.size||D.byteLength)},A)},A,[E,null])};r.readAsText=function(y,A,D){var E=D[0],z=D[1],C=D[2],B=D[3];w("text",E,z,C,B,y,A)};r.readAsDataURL=function(y,z,C){var D=C[0],B=C[1],A=C[2];w("dataURL",D,null,B,A,y,z)};r.readAsBinaryString=function(y,z,C){var D=C[0],B=C[1],A=C[2];w("binaryString",D,null,B,A,y,z)};r.readAsArrayBuffer=function(y,z,C){var D=C[0],B=C[1],A=C[2];w("arrayBuffer",D,null,B,A,y,z)};r.removeRecursively=r.remove=function(y,z,B){if(typeof y!=="function"){throw Error("Expected successCallback argument.")}var A=v(B[0]).storagePath;if(A===k.cacheDirectory||A===k.dataDirectory){z(i.NO_MODIFICATION_ALLOWED_ERR);return}function C(D){p["delete"](A,function(){y()},function(){if(z){z()}},D)}r.getDirectory(function(D){C(D.isDirectory)},function(){C(false)},[A,null,{create:false}])};r.getDirectory=function(y,z,C){var B=C[0];var D=C[1];var A=C[2];D=v(B,D);p.get(D.storagePath,function(F){if(!A){A={}}if(A.create===true&&A.exclusive===true&&F){if(z){z(i.PATH_EXISTS_ERR)}return}if(A.create===true&&!F){var E=new h(D.fileName,D.fullPath,new f(D.fsName,l.root));p.put(E,D.storagePath,y,z);return}if(A.create===true&&F){if(F.isDirectory){y(new h(F.name,F.fullPath,F.filesystem))}else{if(z){z(i.INVALID_MODIFICATION_ERR)}}return}if((!A.create||A.create===false)&&!F){if(D.fullPath===o){y(l.root);return}if(z){z(i.NOT_FOUND_ERR)}return}if((!A.create||A.create===false)&&F&&F.isFile){if(z){z(i.TYPE_MISMATCH_ERR)}return}y(new h(F.name,F.fullPath,F.filesystem))},z)};r.getParent=function(y,z,B){if(typeof y!=="function"){throw Error("Expected successCallback argument.")}var A=B[0];if(A===o||A===k.cacheDirectory||A===k.dataDirectory){y(l.root);return}while(A[A.length-1]==="/"){A=A.substr(0,A.length-1)}var D=A.split(o);D.pop();var F=D.pop();var E=D.join(o)+o;var C=E+F+o;if(C===k.cacheDirectory||C===k.dataDirectory){r.getDirectory(y,z,[C,o,{create:false}]);return}r.getDirectory(y,z,[E,F,{create:false}])};r.copyTo=function(y,A,C){var D=C[0];var z=C[1];var B=C[2];if(B.indexOf("/")!==-1||D===z+B){if(A){A(i.INVALID_MODIFICATION_ERR)}return}r.getFile(function(F){var E=v(z);r.getDirectory(function(){r.getFile(function(G){r.write(function(){y(G)},A,[G.file_.storagePath,F.file_.blob_,0])},A,[z,B,{create:true}])},function(){if(A){A(i.NOT_FOUND_ERR)}},[E.storagePath,null,{create:false}])},A,[D,null])};r.moveTo=function(y,A,C){var D=C[0];var z=C[1];var B=C[2];r.copyTo(function(E){r.remove(function(){y(E)},A,[D])},A,C)};r.resolveLocalFileSystemURI=function(z,C,E){var G=E[0];if(G.indexOf("?")!==-1){G=String(G).split("?")[0]}if(/\%5/g.test(G)||/\%20/g.test(G)){G=decodeURI(G)}if(G.trim()[0]==="/"){if(C){C(i.ENCODING_ERR)}return}if(G.trim().substr(0,7)==="cdvfile"){if(G.indexOf("cdvfile://localhost")===-1){if(C){C(i.ENCODING_ERR)}return}var y=G.indexOf("persistent");var A=G.indexOf("temporary");if(y!==-1){G="file:///persistent"+G.substr(y+10)}else{if(A!==-1){G="file:///temporary"+G.substr(A+9)}else{if(C){C(i.ENCODING_ERR)}return}}}function D(J){var H=0;for(var I=0;I<J.length-1;I++){if(J[I]===o&&J[I+1]===o){H=I+1}else{break}}return J.substr(H)}if(G.indexOf("file://localhost/")===0){G=G.replace("file://localhost/","file:///")}if(G.indexOf(k.dataDirectory)===0){G=G.substring(k.dataDirectory.length-1);G=D(G);r.requestFileSystem(function(){r.getFile(z,function(){r.getDirectory(z,C,[k.dataDirectory,G,{create:false}])},[k.dataDirectory,G,{create:false}])},C,[e.PERSISTENT])}else{if(G.indexOf(k.cacheDirectory)===0){G=G.substring(k.cacheDirectory.length-1);G=D(G);r.requestFileSystem(function(){r.getFile(z,function(){r.getDirectory(z,C,[k.cacheDirectory,G,{create:false}])},[k.cacheDirectory,G,{create:false}])},C,[e.TEMPORARY])}else{if(G.indexOf(k.applicationDirectory)===0){G=G.substring(k.applicationDirectory.length);var F=new XMLHttpRequest();F.open("GET",G,true);F.onreadystatechange=function(){if(F.status===200&&F.readyState===4){r.requestFileSystem(function(H){H.name=location.hostname;H.root.getFile(G,{create:true},B,C)},C,[e.PERSISTENT])}};F.onerror=function(){if(C){C(i.NOT_READABLE_ERR)}};F.send()}else{if(C){C(i.NOT_FOUND_ERR)}}}}function B(H){H.createWriter(function(I){I.onwriteend=function(J){if(!J.target.error){H.filesystemName=location.hostname;z(H)}};I.onerror=function(){if(C){C(i.NOT_READABLE_ERR)}};I.write(new Blob([F.response]))},C)}};r.requestAllPaths=function(y){y(k)};function u(y){var z=new Blob();this.size=y.size||0;this.name=y.name||"";this.type=y.type||"";this.lastModifiedDate=y.lastModifiedDate||null;this.storagePath=y.storagePath||"";Object.defineProperty(this,"blob_",{enumerable:true,get:function(){return z},set:function(A){z=A;this.size=z.size;this.name=z.name;this.type=z.type;this.lastModifiedDate=z.lastModifiedDate}.bind(this)})}u.prototype.constructor=u;function v(z,H){H=H||"";var A=H;var D="";z=z||o;if(z.indexOf(FILESYSTEM_PREFIX)===0){D=z.substring(0,z.indexOf(o,FILESYSTEM_PREFIX.length));z=z.substring(z.indexOf(o,FILESYSTEM_PREFIX.length))}var E=H[0]!==o;if(E){A=z;if(z!==o){A+=o+H}else{A+=H}}var G=new RegExp(o+o,"g");A=A.replace(G,o);var B=A.split(o);for(var C=0;C<B.length;++C){var y=B[C];if(y===".."){B[C-1]="";B[C]=""}}A=B.filter(function(I){return I}).join(o);if(A[0]!==o){A=o+A}A=A.replace(/\.\//g,o);A=A.replace(/\/\//g,o);A=A.replace(/\/\./g,o);if(A[A.length-1]===o&&A!==o){A=A.substring(0,A.length-1)}var F=D+A;F=decodeURI(F);A=decodeURI(A);return{storagePath:F,fullPath:A,fileName:A.split(o).pop(),fsName:D.split(o).pop()}}function m(z){var y=new j(z.name,z.fullPath,z.filesystem);y.file_=z.file_;return y}function w(E,C,D,B,A,y,z){r.getFile(function(H){var F=new FileReader(),G=H.file_.blob_.slice(B,A);F.onload=function(I){y(I.target.result)};F.onerror=z;switch(E){case"text":F.readAsText(G,D);break;case"dataURL":F.readAsDataURL(G);break;case"arrayBuffer":F.readAsArrayBuffer(G);break;case"binaryString":F.readAsBinaryString(G);break}},z,[C,null])}p.open=function(C,y,A){var z=this;var B=q.open(C.replace(":","_"));B.onerror=A||s;B.onupgradeneeded=function(D){z.db=D.target.result;z.db.onerror=s;if(!z.db.objectStoreNames.contains(x)){z.db.createObjectStore(x)}};B.onsuccess=function(D){z.db=D.target.result;z.db.onerror=s;y(D)};B.onblocked=A||s};p.close=function(){this.db.close();this.db=null};p.get=function(B,y,A){if(!this.db){if(A){A(i.INVALID_MODIFICATION_ERR)}return}var z=this.db.transaction([x],"readonly");var C=z.objectStore(x).get(B);z.onabort=A||s;z.oncomplete=function(){y(C.result)}};p.getAllEntries=function(C,F,y,B){if(!this.db){if(B){B(i.INVALID_MODIFICATION_ERR)}return}var D=[];if(F[F.length-1]===o){F=F.substring(0,F.length-1)}var A=IDBKeyRange.bound(F+o+" ",F+o+String.fromCharCode(t));var z=this.db.transaction([x],"readonly");z.onabort=B||s;z.oncomplete=function(){D=D.filter(function(J){var G=J.fullPath;if(J.fullPath[J.fullPath.length-1]===o){G=G.substr(0,G.length-1)}var I=G.split(o).length;var H=C.split(o).length;if(C[C.length-1]===o&&C.trim().length===2){H=1}else{if(C[C.length-1]===o){H=C.substr(0,C.length-1).split(o).length}else{H=C.split(o).length}}if(I===H+1){return J}else{return false}});y(D)};var E=z.objectStore(x).openCursor(A);E.onsuccess=function(G){var I=G.target.result;if(I){var H=I.value;D.push(H.isFile?m(H):new h(H.name,H.fullPath,H.filesystem));I["continue"]()}}};p["delete"]=function(B,y,A,C){if(!p.db){if(A){A(i.INVALID_MODIFICATION_ERR)}return}var z=this.db.transaction([x],"readwrite");z.oncomplete=y;z.onabort=A||s;z.oncomplete=function(){if(C){B=B+o;var D=IDBKeyRange.bound(B+" ",B+String.fromCharCode(t));var E=this.db.transaction([x],"readwrite");E.oncomplete=y;E.onabort=A||s;E.objectStore(x)["delete"](D)}else{y()}};z.objectStore(x)["delete"](B)};p.put=function(B,C,y,A){if(!this.db){if(A){A(i.INVALID_MODIFICATION_ERR)}return}var z=this.db.transaction([x],"readwrite");z.onabort=A||s;z.oncomplete=function(){y(B)};z.objectStore(x).put(B,C)};function s(y){switch(y.target.errorCode){case 12:console.log("Error - Attempt to open db with a lower version than the current one.");break;default:console.log("errorCode: "+y.target.errorCode)}console.log(y,y.code,y.message)}})(c.exports,window);b("cordova/exec/proxy").add("File",c.exports)})()});