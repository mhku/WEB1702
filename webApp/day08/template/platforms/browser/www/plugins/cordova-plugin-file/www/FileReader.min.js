cordova.define("cordova-plugin-file.FileReader",function(e,g,b){var f=e("cordova/exec"),h=e("cordova/modulemapper"),l=e("cordova/utils"),j=e("./FileError"),d=e("./ProgressEvent"),n=h.getOriginalSymbol(window,"FileReader");var c=function(){this._readyState=0;this._error=null;this._result=null;this._progress=null;this._localURL="";this._realReader=n?new n():{}};c.READ_CHUNK_SIZE=256*1024;c.EMPTY=0;c.LOADING=1;c.DONE=2;l.defineGetter(c.prototype,"readyState",function(){return this._localURL?this._readyState:this._realReader.readyState});l.defineGetter(c.prototype,"error",function(){return this._localURL?this._error:this._realReader.error});l.defineGetter(c.prototype,"result",function(){return this._localURL?this._result:this._realReader.result});function a(o){l.defineGetterSetter(c.prototype,o,function(){return this._realReader[o]||null},function(p){this._realReader[o]=p})}a("onloadstart");a("onprogress");a("onload");a("onerror");a("onloadend");a("onabort");function i(o,p){if(o.readyState==c.LOADING){throw new j(j.INVALID_STATE_ERR)}o._result=null;o._error=null;o._progress=0;o._readyState=c.LOADING;if(typeof p.localURL=="string"){o._localURL=p.localURL}else{o._localURL="";return true}if(o.onloadstart){o.onloadstart(new d("loadstart",{target:o}))}}function m(q,u,v,p,o,t){if(this._readyState===c.DONE){return}if(typeof t!=="undefined"){o(t);this._progress=Math.min(this._progress+c.READ_CHUNK_SIZE,p);if(typeof this.onprogress==="function"){this.onprogress(new d("progress",{loaded:this._progress,total:p}))}}if(typeof t==="undefined"||this._progress<p){var s=[this._localURL,v+this._progress,v+this._progress+Math.min(p-this._progress,c.READ_CHUNK_SIZE)];if(u){s.splice(1,0,u)}f(m.bind(this,q,u,v,p,o),k.bind(this),"File",q,s)}else{this._readyState=c.DONE;if(typeof this.onload==="function"){this.onload(new d("load",{target:this}))}if(typeof this.onloadend==="function"){this.onloadend(new d("loadend",{target:this}))}}}function k(o){if(this._readyState===c.DONE){return}this._readyState=c.DONE;this._result=null;this._error=new j(o);if(typeof this.onerror==="function"){this.onerror(new d("error",{target:this}))}if(typeof this.onloadend==="function"){this.onloadend(new d("loadend",{target:this}))}}c.prototype.abort=function(){if(n&&!this._localURL){return this._realReader.abort()}this._result=null;if(this._readyState==c.DONE||this._readyState==c.EMPTY){return}this._readyState=c.DONE;if(typeof this.onabort==="function"){this.onabort(new d("abort",{target:this}))}if(typeof this.onloadend==="function"){this.onloadend(new d("loadend",{target:this}))}};c.prototype.readAsText=function(q,r){if(i(this,q)){return this._realReader.readAsText(q,r)}var p=r?r:"UTF-8";var o=q.end-q.start;m.bind(this)("readAsText",p,q.start,o,function(s){if(this._progress===0){this._result=""}this._result+=s}.bind(this))};c.prototype.readAsDataURL=function(p){if(i(this,p)){return this._realReader.readAsDataURL(p)}var o=p.end-p.start;m.bind(this)("readAsDataURL",null,p.start,o,function(q){var s=q.indexOf(",");if(this._progress===0){this._result=q}else{this._result+=q.substring(s+1)}}.bind(this))};c.prototype.readAsBinaryString=function(p){if(i(this,p)){return this._realReader.readAsBinaryString(p)}var o=p.end-p.start;m.bind(this)("readAsBinaryString",null,p.start,o,function(q){if(this._progress===0){this._result=""}this._result+=q}.bind(this))};c.prototype.readAsArrayBuffer=function(p){if(i(this,p)){return this._realReader.readAsArrayBuffer(p)}var o=p.end-p.start;m.bind(this)("readAsArrayBuffer",null,p.start,o,function(q){var s=(this._progress===0?new Uint8Array(o):new Uint8Array(this._result));s.set(new Uint8Array(q),this._progress);this._result=s.buffer}.bind(this))};b.exports=c});