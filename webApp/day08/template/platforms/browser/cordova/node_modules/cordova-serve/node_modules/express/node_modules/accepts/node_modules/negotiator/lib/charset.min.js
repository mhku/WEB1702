module.exports=preferredCharsets;preferredCharsets.preferredCharsets=preferredCharsets;function parseAcceptCharset(d){var c=d.split(",");for(var b=0,a=0;b<c.length;b++){var e=parseCharset(c[b].trim(),b);if(e){c[a++]=e}}c.length=a;return c}function parseCharset(c,b){var a=c.match(/^\s*(\S+?)\s*(?:;(.*))?$/);if(!a){return null}var g=a[1];var d=1;if(a[2]){var f=a[2].split(";");for(var b=0;b<f.length;b++){var e=f[b].trim().split("=");if(e[0]==="q"){d=parseFloat(e[1]);break}}}return{charset:g,q:d,i:b}}function getCharsetPriority(f,e,b){var d={o:-1,q:0,s:0};for(var c=0;c<e.length;c++){var a=specify(f,e[c],b);if(a&&(d.s-a.s||d.q-a.q||d.o-a.o)<0){d=a}}return d}function specify(d,a,b){var c=0;if(a.charset.toLowerCase()===d.toLowerCase()){c|=1}else{if(a.charset!=="*"){return null}}return{i:b,o:a.i,q:a.q,s:c}}function preferredCharsets(e,b){var d=parseAcceptCharset(e===undefined?"*":e||"");if(!b){return d.filter(isQuality).sort(compareSpecs).map(function a(g){return g.charset})}var c=b.map(function f(h,g){return getCharsetPriority(h,d,g)});return c.filter(isQuality).sort(compareSpecs).map(function a(g){return b[c.indexOf(g)]})}function compareSpecs(d,c){return(c.q-d.q)||(c.s-d.s)||(d.o-c.o)||(d.i-c.i)||0}function isQuality(a){return a.q>0};