var common=require("./common");var fs=require("fs");var path=require("path");var XP_DEFAULT_PATHEXT=".com;.exe;.bat;.cmd;.vbs;.vbe;.js;.jse;.wsf;.wsh";function splitPath(a){if(!a){return[]}if(common.platform==="win"){return a.split(";")}else{return a.split(":")}}function checkPath(a){return fs.existsSync(a)&&!fs.statSync(a).isDirectory()}function _which(c,e){if(!e){common.error("must specify command")}var a=process.env.path||process.env.Path||process.env.PATH,d=splitPath(a),b=null;if(e.search(/\//)===-1){d.forEach(function(g){if(b){return}var k=path.resolve(g,e);if(common.platform==="win"){k=k.toUpperCase();var m=process.env.PATHEXT||XP_DEFAULT_PATHEXT;var f=splitPath(m.toUpperCase());var j;for(j=0;j<f.length;j++){var l=f[j];if(k.slice(-l.length)===l&&checkPath(k)){b=k;return}}var h=k;for(j=0;j<f.length;j++){k=h+f[j];if(checkPath(k)){b=k;return}}}else{if(checkPath(k)){b=k;return}}})}if(!checkPath(e)&&!b){return null}b=b||path.resolve(e);return common.ShellString(b)}module.exports=_which;