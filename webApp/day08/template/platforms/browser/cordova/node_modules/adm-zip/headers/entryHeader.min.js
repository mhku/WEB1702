var Utils=require("../util"),Constants=Utils.Constants;module.exports=function(){var o=10,g=10,d=0,h=0,q=0,m=0,e=0,k=0,p=0,a=0,c=0,i=0,j=0,b=0,n=0;var f={};function l(r){var r=new Date(r);q=(r.getFullYear()-1980&127)<<25|(r.getMonth()+1)<<21|r.getDay()<<16|r.getHours()<<11|r.getMinutes()<<5|r.getSeconds()>>1}l(+new Date());return{get made(){return o},set made(r){o=r},get version(){return g},set version(r){g=r},get flags(){return d},set flags(r){d=r},get method(){return h},set method(r){h=r},get time(){return new Date(((q>>25)&127)+1980,((q>>21)&15)-1,(q>>16)&31,(q>>11)&31,(q>>5)&63,(q&31)<<1)},set time(r){l(r)},get crc(){return m},set crc(r){m=r},get compressedSize(){return e},set compressedSize(r){e=r},get size(){return k},set size(r){k=r},get fileNameLength(){return p},set fileNameLength(r){p=r},get extraLength(){return a},set extraLength(r){a=r},get commentLength(){return c},set commentLength(r){c=r},get diskNumStart(){return i},set diskNumStart(r){i=r},get inAttr(){return j},set inAttr(r){j=r},get attr(){return b},set attr(r){b=r},get offset(){return n},set offset(r){n=r},get encripted(){return(d&1)==1},get entryHeaderSize(){return Constants.CENHDR+p+a+c},get realDataOffset(){return n+Constants.LOCHDR+f.fnameLen+f.extraLen},get dataHeader(){return f},loadDataHeaderFromBinary:function(r){var s=r.slice(n,n+Constants.LOCHDR);if(s.readUInt32LE(0)!=Constants.LOCSIG){throw Utils.Errors.INVALID_LOC}f={version:s.readUInt16LE(Constants.LOCVER),flags:s.readUInt16LE(Constants.LOCFLG),method:s.readUInt16LE(Constants.LOCHOW),time:s.readUInt32LE(Constants.LOCTIM),crc:s.readUInt32LE(Constants.LOCCRC),compressedSize:s.readUInt32LE(Constants.LOCSIZ),size:s.readUInt32LE(Constants.LOCLEN),fnameLen:s.readUInt16LE(Constants.LOCNAM),extraLen:s.readUInt16LE(Constants.LOCEXT)}},loadFromBinary:function(r){if(r.length!=Constants.CENHDR||r.readUInt32LE(0)!=Constants.CENSIG){throw Utils.Errors.INVALID_CEN}o=r.readUInt16LE(Constants.CENVEM);g=r.readUInt16LE(Constants.CENVER);d=r.readUInt16LE(Constants.CENFLG);h=r.readUInt16LE(Constants.CENHOW);q=r.readUInt32LE(Constants.CENTIM);m=r.readUInt32LE(Constants.CENCRC);e=r.readUInt32LE(Constants.CENSIZ);k=r.readUInt32LE(Constants.CENLEN);p=r.readUInt16LE(Constants.CENNAM);a=r.readUInt16LE(Constants.CENEXT);c=r.readUInt16LE(Constants.CENCOM);i=r.readUInt16LE(Constants.CENDSK);j=r.readUInt16LE(Constants.CENATT);b=r.readUInt32LE(Constants.CENATX);n=r.readUInt32LE(Constants.CENOFF)},dataHeaderToBinary:function(){var r=new Buffer(Constants.LOCHDR);r.writeUInt32LE(Constants.LOCSIG,0);r.writeUInt16LE(g,Constants.LOCVER);r.writeUInt16LE(d,Constants.LOCFLG);r.writeUInt16LE(h,Constants.LOCHOW);r.writeUInt32LE(q,Constants.LOCTIM);r.writeUInt32LE(m,Constants.LOCCRC);r.writeUInt32LE(e,Constants.LOCSIZ);r.writeUInt32LE(k,Constants.LOCLEN);r.writeUInt16LE(p,Constants.LOCNAM);r.writeUInt16LE(a,Constants.LOCEXT);return r},entryHeaderToBinary:function(){var r=new Buffer(Constants.CENHDR+p+a+c);r.writeUInt32LE(Constants.CENSIG,0);r.writeUInt16LE(o,Constants.CENVEM);r.writeUInt16LE(g,Constants.CENVER);r.writeUInt16LE(d,Constants.CENFLG);r.writeUInt16LE(h,Constants.CENHOW);r.writeUInt32LE(q,Constants.CENTIM);r.writeInt32LE(m,Constants.CENCRC,true);r.writeUInt32LE(e,Constants.CENSIZ);r.writeUInt32LE(k,Constants.CENLEN);r.writeUInt16LE(p,Constants.CENNAM);r.writeUInt16LE(a,Constants.CENEXT);r.writeUInt16LE(c,Constants.CENCOM);r.writeUInt16LE(i,Constants.CENDSK);r.writeUInt16LE(j,Constants.CENATT);r.writeUInt32LE(b,Constants.CENATX);r.writeUInt32LE(n,Constants.CENOFF);r.fill(0,Constants.CENHDR);return r},toString:function(){return'{\n\t"made" : '+o+',\n\t"version" : '+g+',\n\t"flags" : '+d+',\n\t"method" : '+Utils.methodToString(h)+',\n\t"time" : '+q+',\n\t"crc" : 0x'+m.toString(16).toUpperCase()+',\n\t"compressedSize" : '+e+' bytes,\n\t"size" : '+k+' bytes,\n\t"fileNameLength" : '+p+',\n\t"extraLength" : '+a+' bytes,\n\t"commentLength" : '+c+' bytes,\n\t"diskNumStart" : '+i+',\n\t"inAttr" : '+j+',\n\t"attr" : '+b+',\n\t"offset" : '+n+',\n\t"entryHeaderSize" : '+(Constants.CENHDR+p+a+c)+" bytes\n}"}}};