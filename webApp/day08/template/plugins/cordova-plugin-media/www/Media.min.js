var argscheck=require("cordova/argscheck"),utils=require("cordova/utils"),exec=require("cordova/exec");var mediaObjects={};var Media=function(d,a,c,b){argscheck.checkArgs("sFFF","Media",arguments);this.id=utils.createUUID();mediaObjects[this.id]=this;this.src=d;this.successCallback=a;this.errorCallback=c;this.statusCallback=b;this._duration=-1;this._position=-1;exec(null,this.errorCallback,"Media","create",[this.id,this.src])};Media.MEDIA_STATE=1;Media.MEDIA_DURATION=2;Media.MEDIA_POSITION=3;Media.MEDIA_ERROR=9;Media.MEDIA_NONE=0;Media.MEDIA_STARTING=1;Media.MEDIA_RUNNING=2;Media.MEDIA_PAUSED=3;Media.MEDIA_STOPPED=4;Media.MEDIA_MSG=["None","Starting","Running","Paused","Stopped"];Media.get=function(a){return mediaObjects[a]};Media.prototype.play=function(a){exec(null,null,"Media","startPlayingAudio",[this.id,this.src,a])};Media.prototype.stop=function(){var a=this;exec(function(){a._position=0},this.errorCallback,"Media","stopPlayingAudio",[this.id])};Media.prototype.seekTo=function(a){var b=this;exec(function(c){b._position=c},this.errorCallback,"Media","seekToAudio",[this.id,a])};Media.prototype.pause=function(){exec(null,this.errorCallback,"Media","pausePlayingAudio",[this.id])};Media.prototype.getDuration=function(){return this._duration};Media.prototype.getCurrentPosition=function(c,a){var b=this;exec(function(d){b._position=d;c(d)},a,"Media","getCurrentPositionAudio",[this.id])};Media.prototype.startRecord=function(){exec(null,this.errorCallback,"Media","startRecordingAudio",[this.id,this.src])};Media.prototype.stopRecord=function(){exec(null,this.errorCallback,"Media","stopRecordingAudio",[this.id])};Media.prototype.release=function(){exec(null,this.errorCallback,"Media","release",[this.id])};Media.prototype.setVolume=function(a){exec(null,null,"Media","setVolume",[this.id,a])};Media.prototype.setRate=function(a){if(cordova.platformId==="ios"){exec(null,null,"Media","setRate",[this.id,a])}else{console.warn("media.setRate method is currently not supported for",cordova.platformId,"platform.")}};Media.onStatus=function(d,a,b){var c=mediaObjects[d];if(c){switch(a){case Media.MEDIA_STATE:c.statusCallback&&c.statusCallback(b);if(b==Media.MEDIA_STOPPED){c.successCallback&&c.successCallback()}break;case Media.MEDIA_DURATION:c._duration=b;break;case Media.MEDIA_ERROR:c.errorCallback&&c.errorCallback(b);break;case Media.MEDIA_POSITION:c._position=Number(b);break;default:console.error&&console.error("Unhandled Media.onStatus :: "+a);break}}else{console.error&&console.error("Received Media.onStatus callback for unknown media :: "+d)}};module.exports=Media;function onMessageFromNative(a){if(a.action=="status"){Media.onStatus(a.status.id,a.status.msgType,a.status.value)}else{throw new Error("Unknown media action"+a.action)}}if(cordova.platformId==="android"||cordova.platformId==="amazon-fireos"||cordova.platformId==="windowsphone"){var channel=require("cordova/channel");channel.createSticky("onMediaPluginReady");channel.waitForInitialization("onMediaPluginReady");channel.onCordovaReady.subscribe(function(){exec(onMessageFromNative,undefined,"Media","messageChannel",[]);channel.initializationComplete("onMediaPluginReady")})};