var GlobalizationError=require("./GlobalizationError");var l10n_loaded=new Event("l10n_loaded");var l10n_ready=new Event("l10n_ready");var is_l10n_ready=false;document.addEventListener("l10n_loaded",function(){console.log("DEBUG: L10n loaded");navigator.mozL10n.ready(function(){console.log("DEBUG: L10n ready");is_l10n_ready=true;document.dispatchEvent(l10n_ready)})});function callIfL10nReady(a){if(is_l10n_ready){return a()}document.addEventListener("l10n_ready",a)}function loadFile(a,b,f){var d=document.createElement(a);for(var c in b){if(b.hasOwnProperty(c)){d.setAttribute(c,b[c])}}d.onreadystatechange=d.onload=function(){var e=d.readyState;if(!f.done&&(!e||/loaded|complete/.test(e))){f.done=true;f()}};document.head.appendChild(d)}function loadDependencies(){loadFile("link",{rel:"resource",type:"application/l10n",href:"locales/date.ini"},function(){});loadFile("script",{type:"text/javascript",src:"js/l10n.js"},function(){loadFile("script",{type:"text/javascript",src:"js/l10n_date.js"},function(){document.dispatchEvent(l10n_loaded)})})}loadDependencies();function getPreferredLanguage(b,a){callIfL10nReady(function(){b({value:navigator.mozL10n.language.code})})}function getLocaleName(b,a){callIfL10nReady(function(){b(navigator.mozL10n.language.code)})}function dateToString(d,c,f){var b=new Date(f[0].date);var a=f[0].options;callIfL10nReady(function(){var g=new navigator.mozL10n.DateTimeFormat();d({value:e(g,b,a)})});function e(j,h,g){var k=navigator.mozL10n.get("shortDateTimeFormat");if(g){if(g.selector==="date"){return j.localeDateString(h)}if(g.selector==="time"){return j.localeTimeString(h)}if(g.formatLength!=="short"){k=navigator.mozL10n.get("dateTimeFormat");return j.localeString(h,k)}if(g.selector==="time"){return j.localeTimeString(h,k)}}var l=j.localeDateString(h);var i=j.localeTimeString(h);return l+" "+i}}function stringToDate(j,d,b){var a;var g=b[0].dateString;var k=b[0].options;try{a=new Date(g)}catch(f){console.log("Cordova, stringToDate, An error occurred "+f.message);return d(new GlobalizationError(GlobalizationError.PARSING_ERROR,f.message))}if(!a||a==="Invalid Date"){console.log("Cordova, stringToDate, Invalid Date: "+g);return d(new GlobalizationError(GlobalizationError.PARSING_ERROR,"Invalid Date ("+g+")"))}var l={year:a.getFullYear(),month:a.getMonth(),day:a.getDay()};var h={hour:a.getHours(),minute:a.getMinutes(),second:a.getSeconds(),millisecond:a.getMilliseconds()};if(k){if(k.selector==="date"){return j(l)}if(k.selector==="time"){return j(h)}}for(var c in h){if(h.hasOwnProperty(c)){l[c]=h[c]}}j(l)}function getDatePattern(b,c,a){c(GlobalizationError.UNKNOWN_ERROR,"unsupported")}function getDateNames(a,b,c){callIfL10nReady(function(){var f="long";var j="month";var g=c[0].options;if(g){if(g.type==="narrow"){f="short"}else{if(g.type==="genitive"&&g.item==="months"){f=g.type}}if(g.item==="days"){j="weekday"}}var e=(j==="month")?11:6;var d=[];for(var h=0;h<=e;h++){d.push(navigator.mozL10n.get(j+"-"+h+"-"+f))}a({value:d})})}Date.prototype.stdTimezoneOffset=function(){var a=new Date(this.getFullYear(),0,1);var b=new Date(this.getFullYear(),6,1);return Math.max(a.getTimezoneOffset(),b.getTimezoneOffset())};Date.prototype.isDayLightSavingsTime=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};function isDayLightSavingsTime(b,c,d){var a=new Date(d[0].date);b({dst:a.isDayLightSavingsTime()})}function getFirstDayOfWeek(a,b){callIfL10nReady(function(){var c=navigator.mozL10n.get("weekStartsOnMonday");a({value:1+parseInt(c)})})}function numberToString(b,a,c){c(GlobalizationError.UNKNOWN_ERROR,"unsupported")}function stringToNumber(c,b,d,a){d(GlobalizationError.UNKNOWN_ERROR,"unsupported")}function getNumberPattern(b,c,a){c(GlobalizationError.UNKNOWN_ERROR,"unsupported")}function getCurrencyPattern(a,b,c){c(GlobalizationError.UNKNOWN_ERROR,"unsupported")}var Globalization={getLocaleName:getLocaleName,getPreferredLanguage:getPreferredLanguage,dateToString:dateToString,stringToDate:stringToDate,getDatePattern:getDatePattern,getDateNames:getDateNames,isDayLightSavingsTime:isDayLightSavingsTime,getFirstDayOfWeek:getFirstDayOfWeek,numberToString:numberToString,stringToNumber:stringToNumber,getNumberPattern:getNumberPattern,getCurrencyPattern:getCurrencyPattern};require("cordova/exec/proxy").add("Globalization",Globalization);