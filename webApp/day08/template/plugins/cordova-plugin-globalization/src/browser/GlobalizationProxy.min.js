var GlobalizationError=require("./GlobalizationError");var moment=require("cordova-plugin-globalization.moment");function getCrossPlatformLocale(){return navigator.userLanguage||navigator.language}function stdTimezoneOffset(b){var a=new Date(b.getFullYear(),0,20);var c=new Date(b.getFullYear(),6,20);return Math.max(a.getTimezoneOffset(),c.getTimezoneOffset())}function dst(a){return a.getTimezoneOffset()<stdTimezoneOffset(a)}function dstOffsetAbs(b){var a=new Date(b.getFullYear(),0,20).getTimezoneOffset();var d=new Date(b.getFullYear(),6,20).getTimezoneOffset();if(a<0){a=-a}if(d<0){d=-d}var c=a-d;if(c<0){c=-c}return c}function getWeekDayNames(b,d){var a=[],c;for(var e=0;e<7;e++){c=new Date(2014,5,e+1,0,0,0,0);a[e]=c.toLocaleDateString(b,d)}return a}function convertToIntlNumberFormatOptions(a){switch(a.type){case"decimal":return{style:"decimal"};case"currency":throw"'currency' number type is not supported";case"percent":return{style:"percent"};default:throw"The options.type can be 'decimal', 'percent' or 'currency'"}}function convertToMomentLocalizedFormat(c){var b="The options.selector can be 'date', 'time' or 'date and time'";var a="The options.formatLength can be 'short', 'medium', 'long', or 'full'";switch(c.formatLength){case"short":switch(c.selector){case"date and time":return"lll";case"date":return"l";case"time":return"LT";default:throw b}break;case"medium":switch(c.selector){case"date and time":return"LLL";case"date":return"L";case"time":throw"'time' selector does not support 'medium' formatLength";default:throw b}break;case"long":switch(c.selector){case"date and time":return"llll";case"date":return"ll";case"time":throw"'time' selector does not support 'long' formatLength";default:throw b}break;case"full":switch(c.selector){case"date and time":return"LLLL";case"date":return"LL";case"time":return"LTS";default:throw b}break;default:throw a}}function prepareAndGetDateOptions(a){a=a||{formatLength:"short",selector:"date and time"};a.formatLength=a.formatLength||"short";a.selector=a.selector||"date and time";return convertToMomentLocalizedFormat(a)}var globalization={getLocaleName:function(c,a){try{c({value:getCrossPlatformLocale()})}catch(b){a({code:0,message:b.hasOwnProperty("message")?b.message:b})}},numberToString:function(g,a,c){try{var b=c[0].options||{type:"decimal"};b.type=b.type||"decimal";b=convertToIntlNumberFormatOptions(b);var d=new Intl.NumberFormat(getCrossPlatformLocale(),b);g({value:d.format(c[0].number)})}catch(f){a(new GlobalizationError(GlobalizationError.FORMATTING_ERROR,f.hasOwnProperty("message")?f.message:f))}},isDayLightSavingsTime:function(f,a,c){try{var b=new Date(c[0].date);f({dst:dst(b)})}catch(d){a({code:0,message:d.hasOwnProperty("message")?d.message:d})}},getFirstDayOfWeek:function(f,b){try{var a=getCrossPlatformLocale();moment.locale(a);var c=moment().weekday(0).isoWeekday()+1;f({value:c%8+Math.floor(c/8)})}catch(d){b({code:0,message:d.hasOwnProperty("message")?d.message:d})}},getDateNames:function(d,b,g){try{var l=g[0].options||{type:"wide",item:"months"};var h=l.type||"wide";var k=l.item||"item";var j=getCrossPlatformLocale();if(k==="months"&&h==="wide"){l={month:"long"}}else{if(k==="months"&&h==="narrow"){l={month:"short"}}else{if(k==="days"&&h==="wide"){l={weekday:"long"}}else{if(k==="days"&&h==="narrow"){l={weekday:"short"}}else{throw"Incorrect type or item"}}}}var m=[];if(k==="months"){for(var c=0;c<12;c++){var a=new Date(2014,c,20,0,0,0,0);m[c]=a.toLocaleDateString(j,l)}}else{m=getWeekDayNames(j,l)}d({value:m})}catch(f){b({code:0,message:f.hasOwnProperty("message")?f.message:f})}},getDatePattern:function(g,a){try{var c=new Intl.DateTimeFormat(getCrossPlatformLocale());var d=c.hasOwnProperty("resolved")?c.resolved.timeZone:"";var b=dstOffsetAbs(new Date());g({utc_offset:new Date().getTimezoneOffset()*(-60),dst_offset:b*60,timezone:d,pattern:""})}catch(f){a(new GlobalizationError(GlobalizationError.PATTERN_ERROR,f.hasOwnProperty("message")?f.message:f))}},getNumberPattern:function(h,a,c){try{var b=c[0].options||{type:"decimal"};b.type=b.type||"decimal";b=convertToIntlNumberFormatOptions(b);var d=new Intl.NumberFormat(getCrossPlatformLocale(),b);if(!d.hasOwnProperty("resolved")){a("Not supported");return}var f=d.resolved.pattern;h({pattern:f,symbol:"",fraction:0,rounding:0,positive:"",negative:"",decimal:"",grouping:""})}catch(g){a(new GlobalizationError(GlobalizationError.PATTERN_ERROR,g.hasOwnProperty("message")?g.message:g))}},getPreferredLanguage:function(c,a,b){globalization.getLocaleName(c,a)},getCurrencyPattern:function(c,a,b){a("Not supported")},stringToDate:function(g,a,d){try{var c=prepareAndGetDateOptions(d[0].options);moment.locale(getCrossPlatformLocale());var b=moment(d[0].dateString,c).toDate();g({year:b.getFullYear(),month:b.getMonth(),day:b.getDate(),hour:b.getHours(),minute:b.getMinutes(),second:b.getSeconds(),millisecond:b.getMilliseconds()})}catch(f){a(new GlobalizationError(GlobalizationError.PARSING_ERROR,f.hasOwnProperty("message")?f.message:f))}},stringToNumber:function(c,a,b){a("Not supported")},dateToString:function(g,a,d){try{var c=new Date(d[0].date);var b=prepareAndGetDateOptions(d[0].options);moment.locale(getCrossPlatformLocale());g({value:moment(c).format(b)})}catch(f){a(new GlobalizationError(GlobalizationError.FORMATTING_ERROR,f.hasOwnProperty("message")?f.message:f))}}};module.exports=globalization;require("cordova/exec/proxy").add("Globalization",module.exports);