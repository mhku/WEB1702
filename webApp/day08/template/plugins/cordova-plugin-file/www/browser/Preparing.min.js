(function(){if(!require("./isChrome")()){return}var f=require("cordova/channel");var d=require("./FileError");var c=5*1024*1024;var e=new Event("filePluginIsReady");var a=false;var b=false;var h=false;if(!window.requestFileSystem){window.requestFileSystem=function(l,k,m,j){if(j){j("Not supported")}}}else{window.requestFileSystem(window.TEMPORARY,1,g,function(){})}if(!window.resolveLocalFileSystemURL){window.resolveLocalFileSystemURL=function(k,l,j){if(j){j("Not supported")}}}var i=window.resolveLocalFileSystemURL||window.webkitResolveLocalFileSystemURL;window.resolveLocalFileSystemURL=function(l,n,k){if(l.trim().substr(0,7)==="cdvfile"){if(l.indexOf("cdvfile://localhost")!==-1){var p=l.indexOf("persistent");var o=l.indexOf("temporary");var m="filesystem:file:///";if(location.protocol!=="file:"){m="filesystem:"+location.origin+"/"}var j;if(p!==-1){j=m+"persistent"+l.substr(p+10);i(j,n,k);return}if(o!==-1){j=m+"temporary"+l.substr(o+9);i(j,n,k);return}}if(k){k(new d(d.ENCODING_ERR))}}else{i(l,n,k)}};function g(j){j.root.getFile("todelete_658674_833_4_cdv",{create:true},function(n){var l=Object.getPrototypeOf(n);var m=Object.getPrototypeOf(l);var k=m.toURL;m.toURL=function(){var o=k.call(this);if(this.isDirectory&&o.substr(-1)!=="/"){return o+"/"}return o};m.toNativeURL=function(){console.warn("DEPRECATED: Update your code to use 'toURL'");return this.toURL()};m.toInternalURL=function(){if(this.toURL().indexOf("persistent")>-1){return"cdvfile://localhost/persistent"+this.fullPath}if(this.toURL().indexOf("temporary")>-1){return"cdvfile://localhost/temporary"+this.fullPath}};m.setMetadata=function(p,o){if(o){o("Not supported")}};n.createWriter(function(o){var q=o.write;var p=Object.getPrototypeOf(o);p.write=function(s){if(s instanceof Blob){q.apply(this,[s])}else{var r=new Blob([s]);q.apply(this,[r])}};n.remove(function(){a=true},function(){})})})}window.initPersistentFileSystem=function(k,l,j){if(navigator.webkitPersistentStorage){navigator.webkitPersistentStorage.requestQuota(k,l,j);return}j("This browser does not support this function")};window.isFilePluginReadyRaised=function(){return h};window.initPersistentFileSystem(c,function(){console.log("Persistent fs quota granted");b=true},function(j){console.log("Error occured while trying to request Persistent fs quota: "+JSON.stringify(j))});f.onCordovaReady.subscribe(function(){function j(){if(a&&b){window.dispatchEvent(e);h=true}else{setTimeout(j,100)}}j()},false)})();