var cordova=require("cordova"),exec=require("cordova/exec");var STATUS_CRITICAL=5;var STATUS_LOW=20;var Battery=function(){this._level=null;this._isPlugged=null;this.channels={batterystatus:cordova.addWindowEventHandler("batterystatus"),batterylow:cordova.addWindowEventHandler("batterylow"),batterycritical:cordova.addWindowEventHandler("batterycritical")};for(var a in this.channels){this.channels[a].onHasSubscribersChange=Battery.onHasSubscribersChange}};function handlers(){return battery.channels.batterystatus.numHandlers+battery.channels.batterylow.numHandlers+battery.channels.batterycritical.numHandlers}Battery.onHasSubscribersChange=function(){if(this.numHandlers===1&&handlers()===1){exec(battery._status,battery._error,"Battery","start",[])}else{if(handlers()===0){exec(null,null,"Battery","stop",[])}}};Battery.prototype._status=function(a){if(a){if(battery._level!==a.level||battery._isPlugged!==a.isPlugged){if(a.level===null&&battery._level!==null){return}cordova.fireWindowEvent("batterystatus",a);if(!a.isPlugged){if(battery._level>STATUS_CRITICAL&&a.level<=STATUS_CRITICAL){cordova.fireWindowEvent("batterycritical",a)}else{if(battery._level>STATUS_LOW&&a.level<=STATUS_LOW){cordova.fireWindowEvent("batterylow",a)}}}battery._level=a.level;battery._isPlugged=a.isPlugged}}};Battery.prototype._error=function(a){console.log("Error initializing Battery: "+a)};var battery=new Battery();module.exports=battery;