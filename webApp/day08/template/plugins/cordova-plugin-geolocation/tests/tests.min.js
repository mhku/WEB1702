exports.defineAutoTests=function(){var b=function(h,i,j){if(i){if(i.done){return}i.done=true}if(j){expect(false).toBe(true,j)}else{expect(false).toBe(true)}setTimeout(function(){h()})};var f=function(h,i){if(i){if(i.done){return}i.done=true}expect(true).toBe(true);setTimeout(function(){h()})};var e=(cordova.platformId=="windows8")||(cordova.platformId=="windows"&&!WinJS.Utilities.isPhone);var a=null;var d=/(\d)\..+/.exec(device.version);if(d!==null){a=Number(d[1])}var c=cordova.platformId=="android"&&(device.isVirtual||a>=6);var g=false;describe("Geolocation (navigator.geolocation)",function(){it("geolocation.spec.1 should exist",function(){expect(navigator.geolocation).toBeDefined()});it("geolocation.spec.2 should contain a getCurrentPosition function",function(){expect(typeof navigator.geolocation.getCurrentPosition).toBeDefined();expect(typeof navigator.geolocation.getCurrentPosition=="function").toBe(true)});it("geolocation.spec.3 should contain a watchPosition function",function(){expect(typeof navigator.geolocation.watchPosition).toBeDefined();expect(typeof navigator.geolocation.watchPosition=="function").toBe(true)});it("geolocation.spec.4 should contain a clearWatch function",function(){expect(typeof navigator.geolocation.clearWatch).toBeDefined();expect(typeof navigator.geolocation.clearWatch=="function").toBe(true)})});describe("getCurrentPosition method",function(){describe("error callback",function(){it("geolocation.spec.5 should be called if we set timeout to 0 and maximumAge to a very small number",function(h){if(e||c){pending()}navigator.geolocation.getCurrentPosition(b.bind(null,h),f.bind(null,h),{maximumAge:0,timeout:0})});it("geolocation.spec.9 on failure should return PositionError object with error code constants",function(h){if(e||c){pending()}navigator.geolocation.getCurrentPosition(b.bind(this,h),function(i){expect(i.PERMISSION_DENIED).toBe(1);expect(i.POSITION_UNAVAILABLE).toBe(2);expect(i.TIMEOUT).toBe(3);h()},{maximumAge:0,timeout:0})})});describe("success callback",function(){it("geolocation.spec.6 should be called with a Position object",function(h){if(e||c){pending()}navigator.geolocation.getCurrentPosition(function(i){expect(i.coords).toBeDefined();expect(i.timestamp).toBeDefined();h()},function(i){if(i.message&&i.message.indexOf("kCLErrorDomain")>-1){console.log("Error: Location not set in simulator, tests will fail.");expect(true).toBe(true);g=true;h()}else{b(h)}},{maximumAge:(5*60*1000)})},25000)})});describe("watchPosition method",function(){beforeEach(function(h){setTimeout(function(){h()},100)});describe("error callback",function(){var h=null;afterEach(function(){navigator.geolocation.clearWatch(h)});it("geolocation.spec.7 should be called if we set timeout to 0 and maximumAge to a very small number",function(i){if(e||c){pending()}var j=this;h=navigator.geolocation.watchPosition(b.bind(null,i,j,"Unexpected win"),f.bind(null,i,j),{maximumAge:0,timeout:0})});it("geolocation.spec.10 on failure should return PositionError object with error code constants",function(i){if(e||c){pending()}var j=this;h=navigator.geolocation.watchPosition(b.bind(this,i,j,"Unexpected win"),function(k){if(j.done){return}j.done=true;expect(k.PERMISSION_DENIED).toBe(1);expect(k.POSITION_UNAVAILABLE).toBe(2);expect(k.TIMEOUT).toBe(3);i()},{maximumAge:0,timeout:0})})});describe("success callback",function(){var h=null;afterEach(function(){navigator.geolocation.clearWatch(h)});it("geolocation.spec.8 should be called with a Position object",function(i){if(e||c||g){pending()}var j=this;h=navigator.geolocation.watchPosition(function(k){if(j.done){return}j.done=true;expect(k.coords).toBeDefined();expect(k.timestamp).toBeDefined();setTimeout(function(){i()})},b.bind(null,i,j,"Unexpected fail callback"),{maximumAge:(5*60*1000)});expect(h).toBeDefined()})})})};exports.defineManualTests=function(h,d){var a=null;var b=function(){var v=navigator.geolocation;if(!v){alert("navigator.geolocation object is missing.");return}var w=function(x){s(x)};var u=function(x){console.log("watchLocation fail callback with error code "+x);p(v)};a=v.watchPosition(w,u,{enableHighAccuracy:true});o("Running")};var p=function(){var u=navigator.geolocation;if(!u){alert("navigator.geolocation object is missing.");return}o("Stopped");if(a){u.clearWatch(a);a=null}};var t=function(v){var w=navigator.geolocation;if(!w){alert("navigator.geolocation object is missing.");return}p(w);var x=function(y){s(y);o("Done")};var u=function(y){console.log("getLocation fail callback with error code "+y.code);o("Error: "+y.code)};o("Retrieving location...");w.getCurrentPosition(x,u,v||{enableHighAccuracy:true})};var o=function(u){document.getElementById("location_status").innerHTML=u};var s=function(v){var u=(new Date(v.timestamp));document.getElementById("latitude").innerHTML=v.coords.latitude;document.getElementById("longitude").innerHTML=v.coords.longitude;document.getElementById("altitude").innerHTML=v.coords.altitude;document.getElementById("accuracy").innerHTML=v.coords.accuracy;document.getElementById("heading").innerHTML=v.coords.heading;document.getElementById("speed").innerHTML=v.coords.speed;document.getElementById("altitude_accuracy").innerHTML=v.coords.altitudeAccuracy;document.getElementById("timestamp").innerHTML=u.toDateString()+" "+u.toTimeString()};var r='<div id="info"><b>Status:</b> <span id="location_status">Stopped</span><table width="100%">',n='<tr><td><b>Latitude:</b></td><td id="latitude">&nbsp;</td><td>(decimal degrees) geographic coordinate [<a href="http://dev.w3.org/geo/api/spec-source.html#lat">#ref]</a></td></tr>',l='<tr><td><b>Longitude:</b></td><td id="longitude">&nbsp;</td><td>(decimal degrees) geographic coordinate [<a href="http://dev.w3.org/geo/api/spec-source.html#lat">#ref]</a></td></tr>',j='<tr><td><b>Altitude:</b></td><td id="altitude">&nbsp;</td><td>null if not supported;<br>(meters) height above the [<a href="http://dev.w3.org/geo/api/spec-source.html#ref-wgs">WGS84</a>] ellipsoid. [<a href="http://dev.w3.org/geo/api/spec-source.html#altitude">#ref]</a></td></tr>',m='<tr><td><b>Accuracy:</b></td><td id="accuracy">&nbsp;</td><td>(meters; non-negative; 95% confidence level) the accuracy level of the latitude and longitude coordinates. [<a href="http://dev.w3.org/geo/api/spec-source.html#accuracy">#ref]</a></td></tr>',f='<tr><td><b>Heading:</b></td><td id="heading">&nbsp;</td><td>null if not supported;<br>NaN if speed == 0;<br>(degrees; 0° ≤ heading < 360°) direction of travel of the hosting device- counting clockwise relative to the true north. [<a href="http://dev.w3.org/geo/api/spec-source.html#heading">#ref]</a></td></tr>',q='<tr><td><b>Speed:</b></td><td id="speed">&nbsp;</td><td>null if not supported;<br>(meters per second; non-negative) magnitude of the horizontal component of the hosting device current velocity. [<a href="http://dev.w3.org/geo/api/spec-source.html#speed">#ref]</a></td></tr>',g='<tr><td><b>Altitude Accuracy:</b></td><td id="altitude_accuracy">&nbsp;</td><td>null if not supported;<br>(meters; non-negative; 95% confidence level) the accuracy level of the altitude. [<a href="http://dev.w3.org/geo/api/spec-source.html#altitude-accuracy">#ref]</a></td></tr>',i='<tr><td><b>Time:</b></td><td id="timestamp">&nbsp;</td><td>(DOMTimeStamp) when the position was acquired [<a href="http://dev.w3.org/geo/api/spec-source.html#timestamp">#ref]</a></td></tr></table></div>',k='<div id="cordova-getLocation"></div>Expected result: Will update all applicable values in status box for current location. Status will read Retrieving Location (may not see this if location is retrieved immediately) then Done.<p/> <div id="cordova-watchLocation"></div>Expected result: Will update all applicable values in status box for current location and update as location changes. Status will read Running.<p/> <div id="cordova-stopLocation"></div>Expected result: Will stop watching the location so values will not be updated. Status will read Stopped.<p/> <div id="cordova-getOld"></div>Expected result: Will update location values with a cached position that is up to 30 seconds old. Verify with time value. Status will read Done.',e="<h3>Details about each value are listed below in the status box</h3>",c="<h3>Allow use of current location, if prompted</h3>";h.innerHTML=e+r+n+l+j+m+f+q+g+i+c+k;d("Get Location",function(){t()},"cordova-getLocation");d("Start Watching Location",function(){b()},"cordova-watchLocation");d("Stop Watching Location",function(){p()},"cordova-stopLocation");d("Get Location Up to 30 Sec Old",function(){t({maximumAge:30000})},"cordova-getOld")};